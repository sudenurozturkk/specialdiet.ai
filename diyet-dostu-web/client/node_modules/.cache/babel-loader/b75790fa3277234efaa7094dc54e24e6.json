{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\specialdiet.ai\\\\diyet-dostu-web\\\\client\\\\src\\\\components\\\\Chat.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport ChatBubble from './ChatBubble';\nimport UserInfoForm from './UserInfoForm';\nimport DietPlanGenerator from './DietPlanGenerator';\nconst Chat = () => {\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [imageFile, setImageFile] = useState(null);\n  const [imagePreview, setImagePreview] = useState(null);\n  const [chatList, setChatList] = useState([]);\n  const [activeChatId, setActiveChatId] = useState(null);\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [showUserInfoForm, setShowUserInfoForm] = useState(false);\n  const [showDietPlan, setShowDietPlan] = useState(false);\n  const [userInfo, setUserInfo] = useState(null);\n  const messagesEndRef = useRef(null);\n  const textareaRef = useRef(null);\n  const [apiKey, setApiKey] = useState('');\n  const [keySubmitted, setKeySubmitted] = useState(true);\n  const [assistantMode, setAssistantMode] = useState('general');\n  const [assistantHistory, setAssistantHistory] = useState([]);\n  useEffect(() => {\n    fetchChatList();\n    checkUserInfo();\n\n    // .env veya server API'den API anahtarÄ±nÄ± al\n    fetchApiKey();\n  }, []);\n  useEffect(() => {\n    if (activeChatId) {\n      fetchChatHistory();\n    }\n  }, [activeChatId]);\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages, showUserInfoForm, showDietPlan]);\n  const checkUserInfo = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        return;\n      }\n      const response = await axios.get('/api/user-info', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.data.userInfo) {\n        setUserInfo(response.data.userInfo);\n      } else {\n        // KullanÄ±cÄ± bilgisi yoksa formu gÃ¶ster\n        // GerÃ§ek uygulamada sohbet baÅŸlattÄ±ktan sonra gÃ¶ster\n        // Åžimdilik yorum satÄ±rÄ± olarak bÄ±rakÄ±yoruz\n        // setShowUserInfoForm(true);\n      }\n    } catch (error) {\n      console.error('KullanÄ±cÄ± bilgisi kontrolÃ¼ sÄ±rasÄ±nda hata:', error);\n    }\n  };\n  const fetchChatList = async () => {\n    try {\n      setIsLoading(true);\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        setIsLoading(false);\n        return;\n      }\n      const response = await axios.get('/api/chat-list', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n\n      // Sohbet listesini ayarla\n      setChatList(response.data);\n\n      // Ä°lk sohbeti aktif olarak iÅŸaretle (eÄŸer liste boÅŸ deÄŸilse)\n      if (response.data.length > 0 && !activeChatId) {\n        setActiveChatId(response.data[0].id);\n        fetchChatHistory(response.data[0].id);\n      } else if (response.data.length === 0) {\n        // Sohbet listesi boÅŸsa yeni bir sohbet oluÅŸtur\n        createNewChat();\n      }\n    } catch (error) {\n      console.error('Sohbet listesi alÄ±nÄ±rken hata:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const fetchChatHistory = async chatId => {\n    try {\n      setIsLoading(true);\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        setIsLoading(false);\n        return;\n      }\n      const response = await axios.get(`/api/chat-history/${chatId}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n\n      // BaÅŸarÄ±lÄ± yanÄ±tta mesajlarÄ± gÃ¼ncelle\n      if (response.data.chatHistory && Array.isArray(response.data.chatHistory)) {\n        setMessages(response.data.chatHistory);\n      } else {\n        // BoÅŸ mesaj listesi\n        setMessages([]);\n      }\n    } catch (error) {\n      console.error('Sohbet geÃ§miÅŸi alÄ±nÄ±rken hata:', error);\n      setMessages([]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const createNewChat = () => {\n    try {\n      setIsLoading(true);\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        setIsLoading(false);\n        return;\n      }\n\n      // Yeni sohbet oluÅŸtur\n      axios.post('/api/create-chat', {}, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }).then(response => {\n        if (response.data && response.data.id) {\n          // Yeni sohbeti listeye ekle\n          const newChat = {\n            id: response.data.id,\n            title: response.data.title || 'Yeni Sohbet',\n            lastMessage: new Date().toISOString()\n          };\n          setChatList(prevList => [...prevList, newChat]);\n          setActiveChatId(response.data.id);\n\n          // Yeni sohbetin geÃ§miÅŸini yÃ¼kle (boÅŸ olacak)\n          setMessages([{\n            role: 'assistant',\n            content: `Merhaba! ðŸ˜Š Diyet Dostu'na hoÅŸ geldin!\n\nBen senin kiÅŸisel beslenme ve spor asistanÄ±nÄ±m. Bana istediÄŸin konuda soru sorabilirsin.\n\nTÃ¼rk mutfaÄŸÄ±na uygun, kolay ve saÄŸlÄ±klÄ± tarifler sunarak diyet hedeflerine ulaÅŸmana yardÄ±mcÄ± olacaÄŸÄ±m.\n\nÄ°ÅŸte sana yardÄ±mcÄ± olabileceÄŸim konular:\nðŸ¥— TÃ¼rk mutfaÄŸÄ±na uygun dÃ¼ÅŸÃ¼k kalorili/yÃ¼ksek proteinli tarifler\nðŸ‹ï¸â€â™€ï¸ KiÅŸiselleÅŸtirilmiÅŸ egzersiz planlarÄ±\nðŸ“¸ Yemek fotoÄŸraflarÄ±nÄ± analiz ederek besin deÄŸeri tahmini\nðŸ“ HaftalÄ±k beslenme programÄ± oluÅŸturma\nðŸ“Š Kilo takibi ve geliÅŸim analizi\n\nSormak istediÄŸin bir ÅŸey var mÄ±? Birlikte saÄŸlÄ±klÄ± bir yaÅŸam yolculuÄŸuna baÅŸlayalÄ±m! ðŸ’ª`\n          }]);\n        }\n      }).catch(error => {\n        console.error('Yeni sohbet oluÅŸturulurken hata:', error);\n      }).finally(() => {\n        setIsLoading(false);\n      });\n    } catch (error) {\n      console.error('Yeni sohbet oluÅŸturulurken hata:', error);\n      setIsLoading(false);\n    }\n  };\n  const deleteChat = async chatId => {\n    if (!window.confirm('Bu sohbeti silmek istediÄŸinizden emin misiniz?')) {\n      return;\n    }\n    try {\n      setIsLoading(true);\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        setIsLoading(false);\n        return;\n      }\n\n      // API'ya istek gÃ¶nder\n      const response = await axios.delete(`/api/delete-chat/${chatId}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n\n      // BaÅŸarÄ±lÄ± yanÄ±tta UI'Ä± gÃ¼ncelle\n      if (response.data.success) {\n        // Sohbet listesinden sil\n        setChatList(prevList => prevList.filter(chat => chat.id !== chatId));\n\n        // EÄŸer aktif sohbet siliniyorsa baÅŸka bir sohbete geÃ§\n        if (chatId === activeChatId) {\n          const remainingChats = chatList.filter(chat => chat.id !== chatId);\n          const nextChat = remainingChats.length > 0 ? remainingChats[0] : null;\n          if (nextChat) {\n            setActiveChatId(nextChat.id);\n            // Bu sohbetin geÃ§miÅŸini yÃ¼kle\n            fetchChatHistory(nextChat.id);\n          } else {\n            // HiÃ§ sohbet kalmadÄ±ysa yeni bir sohbet oluÅŸtur\n            createNewChat();\n          }\n        }\n\n        // Bildirim gÃ¶ster\n        alert('Sohbet baÅŸarÄ±yla silindi.');\n      } else {\n        alert('Sohbet silinirken bir hata oluÅŸtu.');\n      }\n    } catch (error) {\n      console.error('Sohbet silinirken hata:', error);\n      alert('Sohbet silinirken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const clearChatHistory = async () => {\n    try {\n      if (!window.confirm('Sohbet geÃ§miÅŸini temizlemek istediÄŸinizden emin misiniz?')) {\n        return;\n      }\n      setIsLoading(true);\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        setIsLoading(false);\n        return;\n      }\n\n      // API'ya istek gÃ¶nder\n      const response = await axios.post('/api/clear-chat', {}, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.data.success) {\n        // BaÅŸarÄ±lÄ± yanÄ±tta mesajlarÄ± gÃ¼ncelle\n        setMessages(response.data.chatHistory || [{\n          role: 'assistant',\n          content: `Merhaba! ðŸ˜Š Diyet Dostu'na hoÅŸ geldin!\n\nBen senin kiÅŸisel beslenme ve spor asistanÄ±nÄ±m. Sohbet geÃ§miÅŸin temizlendi ve yeni bir konuÅŸma baÅŸlatÄ±ldÄ±.\n\nTÃ¼rk mutfaÄŸÄ±na uygun, kolay ve saÄŸlÄ±klÄ± tarifler sunarak diyet hedeflerine ulaÅŸmana yardÄ±mcÄ± olacaÄŸÄ±m.\n\nÄ°ÅŸte sana yardÄ±mcÄ± olabileceÄŸim konular:\nðŸ¥— TÃ¼rk mutfaÄŸÄ±na uygun dÃ¼ÅŸÃ¼k kalorili/yÃ¼ksek proteinli tarifler\nðŸ‹ï¸â€â™€ï¸ KiÅŸiselleÅŸtirilmiÅŸ egzersiz planlarÄ±\nðŸ“¸ Yemek fotoÄŸraflarÄ±nÄ± analiz ederek besin deÄŸeri tahmini\nðŸ“ HaftalÄ±k beslenme programÄ± oluÅŸturma\nðŸ“Š Kilo takibi ve geliÅŸim analizi\n\nSormak istediÄŸin bir ÅŸey var mÄ±? Birlikte saÄŸlÄ±klÄ± bir yaÅŸam yolculuÄŸuna baÅŸlayalÄ±m! ðŸ’ª`\n        }]);\n\n        // Aktif sohbeti gÃ¼ncelle\n        const updatedList = chatList.map(chat => {\n          if (chat.id === activeChatId) {\n            return {\n              ...chat,\n              title: 'TemizlenmiÅŸ Sohbet'\n            };\n          }\n          return chat;\n        });\n        setChatList(updatedList);\n\n        // FormlarÄ± gizle\n        setShowUserInfoForm(false);\n        setShowDietPlan(false);\n\n        // BaÅŸarÄ± mesajÄ± gÃ¶ster\n        alert('Sohbet geÃ§miÅŸi baÅŸarÄ±yla temizlendi.');\n      } else {\n        // Hata mesajÄ±\n        alert('Sohbet geÃ§miÅŸi temizlenirken bir hata oluÅŸtu.');\n      }\n    } catch (error) {\n      console.error('Sohbet geÃ§miÅŸi temizlenirken hata:', error);\n      // Hata durumunda kullanÄ±cÄ±yÄ± bilgilendir\n      alert('Sohbet geÃ§miÅŸi temizlenirken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const scrollToBottom = () => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  };\n  const handleKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit(e);\n    }\n  };\n  const handleImageUpload = e => {\n    const file = e.target.files[0];\n    if (file) {\n      setImageFile(file);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setImagePreview(reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  const clearImage = () => {\n    setImageFile(null);\n    setImagePreview(null);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!input.trim() && !imageFile || isLoading) return;\n\n    // KullanÄ±cÄ± mesajÄ±nÄ± ekle\n    const userMessage = input.trim();\n    setMessages(prevMessages => [...prevMessages, {\n      role: 'user',\n      content: userMessage\n    }]);\n    setInput('');\n    setIsLoading(true);\n    adjustTextareaHeight();\n\n    // Resim varsa, yÃ¼klenen iÅŸlemi gerÃ§ekleÅŸtir\n    if (imageFile) {\n      try {\n        const formData = new FormData();\n        formData.append('image', imageFile);\n        const token = localStorage.getItem('token');\n        if (!token) {\n          console.error('Token bulunamadÄ±');\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: 'Oturumunuz sona ermiÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.'\n          }]);\n          setIsLoading(false);\n          return;\n        }\n        const response = await axios.post(`/api/analyze-image`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data',\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        clearImage();\n\n        // GÃ¶rÃ¼ntÃ¼ analiz edildikten sonra cevap sohbete eklenecek\n        // API tetikleyecek sohbet geÃ§miÅŸini sunucudan alacak\n        fetchChatHistory(activeChatId);\n      } catch (error) {\n        console.error('GÃ¶rÃ¼ntÃ¼ yÃ¼kleme hatasÄ±:', error);\n        if (error.response) {\n          if (error.response.status === 401) {\n            setMessages(prevMessages => [...prevMessages, {\n              role: 'assistant',\n              content: 'Oturumunuz sona ermiÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.'\n            }]);\n          } else if (error.response.status === 413) {\n            setMessages(prevMessages => [...prevMessages, {\n              role: 'assistant',\n              content: 'GÃ¶rÃ¼ntÃ¼ boyutu Ã§ok bÃ¼yÃ¼k. LÃ¼tfen daha kÃ¼Ã§Ã¼k bir gÃ¶rÃ¼ntÃ¼ yÃ¼kleyin.'\n            }]);\n          } else {\n            setMessages(prevMessages => [...prevMessages, {\n              role: 'assistant',\n              content: 'GÃ¶rÃ¼ntÃ¼yÃ¼ iÅŸlerken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.'\n            }]);\n          }\n        } else {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: 'GÃ¶rÃ¼ntÃ¼yÃ¼ iÅŸlerken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.'\n          }]);\n        }\n        clearImage();\n        setIsLoading(false);\n      }\n      return;\n    }\n    try {\n      // KiÅŸisel bilgi sorusu\n      if (userMessage.toLowerCase().includes('kiÅŸisel bilgi') || userMessage.toLowerCase().includes('bilgilerim') || userMessage.toLowerCase().includes('profilim')) {\n        setIsLoading(false);\n        setShowUserInfoForm(true);\n        return;\n      }\n\n      // Diyet planÄ± istemi\n      if (userMessage.toLowerCase().includes('diyet planÄ±') || userMessage.toLowerCase().includes('beslenme planÄ±')) {\n        setIsLoading(false);\n        setShowDietPlan(true);\n\n        // Bilgi eksikliÄŸi kontrolÃ¼\n        if (!userInfo || !userInfo.weight || !userInfo.height || !userInfo.age) {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: 'Size Ã¶zel bir diyet planÄ± oluÅŸturabilmem iÃ§in kiÅŸisel bilgilerinize ihtiyacÄ±m var. LÃ¼tfen kiÅŸisel bilgilerinizi gÃ¼ncelleyin.'\n          }]);\n          setShowUserInfoForm(true);\n        }\n        return;\n      }\n\n      // AI Asistan modu komutlarÄ± kontrolÃ¼\n      if (userMessage.toLowerCase().includes('diyetisyen ol') || userMessage.toLowerCase().includes('diyetisyen modu')) {\n        changeAssistantMode('dietician');\n        setIsLoading(false);\n        return;\n      }\n      if (userMessage.toLowerCase().includes('fitness') || userMessage.toLowerCase().includes('antrenÃ¶r ol') || userMessage.toLowerCase().includes('egzersiz modu')) {\n        changeAssistantMode('fitness');\n        setIsLoading(false);\n        return;\n      }\n      if (userMessage.toLowerCase().includes('ÅŸef ol') || userMessage.toLowerCase().includes('aÅŸÃ§Ä± ol') || userMessage.toLowerCase().includes('tarif modu')) {\n        changeAssistantMode('chef');\n        setIsLoading(false);\n        return;\n      }\n      if (userMessage.toLowerCase().includes('genel mod') || userMessage.toLowerCase().includes('normal mod')) {\n        changeAssistantMode('general');\n        setIsLoading(false);\n        return;\n      }\n\n      // AI asistan isteÄŸini hazÄ±rla\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        setMessages(prevMessages => [...prevMessages, {\n          role: 'assistant',\n          content: 'Oturumunuz sona ermiÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.'\n        }]);\n        setIsLoading(false);\n        return;\n      }\n\n      // Asistan moduna gÃ¶re prompt'u hazÄ±rla\n      let enhancedPrompt = userMessage;\n      if (assistantMode === 'dietician') {\n        enhancedPrompt = `[DÄ°YETÄ°SYEN MODU] Bir diyetisyen olarak yanÄ±t ver: ${userMessage}`;\n      } else if (assistantMode === 'fitness') {\n        enhancedPrompt = `[FÄ°TNESS MODU] Bir fitness antrenÃ¶rÃ¼ olarak yanÄ±t ver: ${userMessage}`;\n      } else if (assistantMode === 'chef') {\n        enhancedPrompt = `[ÅžEF MODU] Bir ÅŸef olarak saÄŸlÄ±klÄ± tarifler Ã¶ner: ${userMessage}`;\n      }\n      const response = await axios.post(`/api/chat`, {\n        message: enhancedPrompt,\n        chatId: activeChatId,\n        assistantMode: assistantMode\n      }, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      // Sunucudan gelen yanÄ±tÄ± ekle\n      if (response.data && response.data.response) {\n        setMessages(prevMessages => [...prevMessages, {\n          role: 'assistant',\n          content: response.data.response\n        }]);\n      }\n    } catch (error) {\n      console.error('Mesaj gÃ¶nderme hatasÄ±:', error);\n      if (error.response) {\n        if (error.response.status === 401) {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: 'Oturumunuz sona ermiÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.'\n          }]);\n        } else if (error.response.status === 403) {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: 'Bu iÅŸlemi gerÃ§ekleÅŸtirmek iÃ§in yetkiniz yok.'\n          }]);\n        } else if (error.response.status === 404) {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: 'API endpoint\\'i bulunamadÄ±.'\n          }]);\n        } else if (error.response.status === 500) {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: 'Sunucu hatasÄ±. LÃ¼tfen daha sonra tekrar deneyin.'\n          }]);\n        } else {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: 'Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.'\n          }]);\n        }\n      } else if (error.request) {\n        setMessages(prevMessages => [...prevMessages, {\n          role: 'assistant',\n          content: 'Sunucuya baÄŸlanÄ±rken bir hata oluÅŸtu. Ä°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin.'\n        }]);\n      } else {\n        setMessages(prevMessages => [...prevMessages, {\n          role: 'assistant',\n          content: 'Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.'\n        }]);\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleUserInfoSubmit = formData => {\n    // KullanÄ±cÄ± bilgilerini kaydet\n    setUserInfo(formData);\n    setShowUserInfoForm(false);\n\n    // KullanÄ±cÄ± bilgileri alÄ±ndÄ±ÄŸÄ±nda diyet planÄ±nÄ± gÃ¶ster\n    setTimeout(() => {\n      setMessages(prev => [...prev, {\n        role: 'assistant',\n        content: `TeÅŸekkÃ¼rler! Bilgileriniz kaydedildi. \n\nSize Ã¶zel bir beslenme planÄ± hazÄ±rlÄ±yorum. Bu plan, hedeflerinize, tercihlerinize ve ihtiyaÃ§larÄ±nÄ±za gÃ¶re Ã¶zelleÅŸtirilmiÅŸtir.\n\nÄ°ÅŸte size Ã¶zel beslenme planÄ±m:`\n      }]);\n      setTimeout(() => {\n        setShowDietPlan(true);\n      }, 1000);\n    }, 500);\n  };\n  const toggleSidebar = () => {\n    setSidebarOpen(!sidebarOpen);\n  };\n\n  // Eksik olduÄŸu iÃ§in not silme fonksiyonunu ekliyorum\n  const deleteNote = async noteId => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        return;\n      }\n      const response = await axios.delete(`/api/delete-note/${noteId}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.data.success) {\n        // Notu listeden kaldÄ±r\n        setMessages(messages.filter(msg => {\n          // Not ID'si mesaj iÃ§inde tanÄ±mlanmÄ±ÅŸsa (data-note-id gibi bir Ã¶zellik ile)\n          return !(msg.type === 'note' && msg.noteId === noteId);\n        }));\n\n        // Bildirim gÃ¶ster\n        alert('Not baÅŸarÄ±yla silindi');\n      } else {\n        alert('Not silinirken bir hata oluÅŸtu');\n      }\n    } catch (error) {\n      console.error('Not silinirken hata:', error);\n      alert('Not silinirken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');\n    }\n  };\n  const handleSubmitApiKey = e => {\n    e.preventDefault();\n    if (apiKey) {\n      localStorage.setItem('geminiApiKey', apiKey);\n      setKeySubmitted(true);\n\n      // API anahtarÄ±nÄ± sunucuya gÃ¶nder\n      const token = localStorage.getItem('token');\n      if (token) {\n        axios.post('/api/save-api-key', {\n          apiKey\n        }, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        }).catch(error => {\n          console.error('API anahtarÄ± kaydedilirken hata:', error);\n        });\n      }\n    }\n  };\n\n  // API anahtarÄ±nÄ± sunucudan veya .env dosyasÄ±ndan al\n  const fetchApiKey = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('Token bulunamadÄ±');\n        return;\n      }\n\n      // Sunucudan API anahtarÄ±nÄ± alma isteÄŸi\n      const response = await axios.get('/api/get-api-key', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.data && response.data.apiKey) {\n        setApiKey(response.data.apiKey);\n        setKeySubmitted(true);\n      } else {\n        // EÄŸer localStorage'da kayÄ±tlÄ± bir anahtar varsa onu kullan\n        const savedKey = localStorage.getItem('geminiApiKey');\n        if (savedKey) {\n          setApiKey(savedKey);\n          setKeySubmitted(true);\n        } else {\n          // EÄŸer API anahtarÄ± yoksa ve kullanÄ±cÄ± girmediyse, modal gÃ¶ster\n          setKeySubmitted(false);\n        }\n      }\n    } catch (error) {\n      console.error('API anahtarÄ± alÄ±nÄ±rken hata:', error);\n\n      // EÄŸer localStorage'da kayÄ±tlÄ± bir anahtar varsa onu kullan\n      const savedKey = localStorage.getItem('geminiApiKey');\n      if (savedKey) {\n        setApiKey(savedKey);\n        setKeySubmitted(true);\n      } else {\n        // EÄŸer API anahtarÄ± yoksa ve kullanÄ±cÄ± girmediyse, modal gÃ¶ster\n        setKeySubmitted(false);\n      }\n    }\n  };\n\n  // Asistan modlarÄ±nÄ± deÄŸiÅŸtirme fonksiyonu\n  const changeAssistantMode = mode => {\n    setAssistantMode(mode);\n    // KullanÄ±cÄ±ya mod deÄŸiÅŸikliÄŸi hakkÄ±nda bilgi ver\n    const modeMessages = {\n      'general': 'Genel mod: Size saÄŸlÄ±klÄ± yaÅŸam konusunda yardÄ±mcÄ± olabilirim.',\n      'dietician': 'Diyetisyen mod: Size kiÅŸisel beslenme planÄ± ve Ã¶neriler sunabilirim.',\n      'fitness': 'Fitness mod: Size egzersiz programlarÄ± ve aktivite Ã¶nerileri sunabilirim.',\n      'chef': 'Åžef mod: Size saÄŸlÄ±klÄ± ve lezzetli tarifler Ã¶nerebilirim.'\n    };\n\n    // Mod deÄŸiÅŸikliÄŸi mesajÄ±nÄ± ekle\n    setMessages(prev => [...prev, {\n      role: 'assistant',\n      content: modeMessages[mode],\n      timestamp: new Date().toISOString()\n    }]);\n\n    // Yeni modun baÄŸlamÄ±nÄ± korumak iÃ§in histori kaydet\n    setAssistantHistory(prev => [...prev, {\n      mode,\n      startIndex: messages.length\n    }]);\n  };\n\n  // MesajÄ± asistan moduna gÃ¶re render et\n  const renderMessageWithMode = (msg, index) => {\n    let messageClass = \"message\";\n    let avatarIcon = \"ðŸ¥—\";\n\n    // Asistan moduna gÃ¶re ikon belirle\n    if (msg.role === 'assistant') {\n      if (assistantHistory.length > 0) {\n        // MesajÄ±n hangi modda gÃ¶nderildiÄŸini bul\n        const messageMode = assistantHistory.reduce((current, historyItem) => {\n          if (index >= historyItem.startIndex) {\n            return historyItem.mode;\n          }\n          return current;\n        }, 'general');\n\n        // Moda gÃ¶re ikon belirle\n        switch (messageMode) {\n          case 'dietician':\n            avatarIcon = \"ðŸ¥—\";\n            messageClass += \" dietician-message\";\n            break;\n          case 'fitness':\n            avatarIcon = \"ðŸ’ª\";\n            messageClass += \" fitness-message\";\n            break;\n          case 'chef':\n            avatarIcon = \"ðŸ‘¨â€ðŸ³\";\n            messageClass += \" chef-message\";\n            break;\n          default:\n            avatarIcon = \"ðŸ¤–\";\n            messageClass += \" general-message\";\n        }\n      }\n    }\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: index,\n      className: `message-container ${msg.role}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 750,\n        columnNumber: 7\n      }\n    }, msg.role === 'assistant' && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"avatar-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 752,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"assistant-avatar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 753,\n        columnNumber: 13\n      }\n    }, avatarIcon)), /*#__PURE__*/React.createElement(\"div\", {\n      className: msg.role === 'user' ? 'user-message' : messageClass,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 756,\n        columnNumber: 9\n      }\n    }, msg.content));\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 764,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `sidebar ${sidebarOpen ? 'open' : ''}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 765,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebar-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 766,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 767,\n      columnNumber: 11\n    }\n  }, \"Sohbetler\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: createNewChat,\n    className: \"new-chat-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 768,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"16\",\n    height: \"16\",\n    fill: \"currentColor\",\n    viewBox: \"0 0 24 24\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 769,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12 4v16m8-8H4\",\n    strokeWidth: \"2\",\n    stroke: \"currentColor\",\n    strokeLinecap: \"round\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 770,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 772,\n      columnNumber: 13\n    }\n  }, \"Yeni Sohbet\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"assistant-mode-switcher\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 777,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 778,\n      columnNumber: 11\n    }\n  }, \"Asistan Modu\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mode-buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 779,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: `mode-button ${assistantMode === 'general' ? 'active' : ''}`,\n    onClick: () => changeAssistantMode('general'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 780,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 784,\n      columnNumber: 15\n    }\n  }, \"\\uD83E\\uDD16\"), \" Genel\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: `mode-button ${assistantMode === 'dietician' ? 'active' : ''}`,\n    onClick: () => changeAssistantMode('dietician'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 786,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 790,\n      columnNumber: 15\n    }\n  }, \"\\uFFFD\\uFFFD\"), \" Diyetisyen\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: `mode-button ${assistantMode === 'fitness' ? 'active' : ''}`,\n    onClick: () => changeAssistantMode('fitness'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 792,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 796,\n      columnNumber: 15\n    }\n  }, \"\\uD83D\\uDCAA\"), \" Fitness\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: `mode-button ${assistantMode === 'chef' ? 'active' : ''}`,\n    onClick: () => changeAssistantMode('chef'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 798,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 802,\n      columnNumber: 15\n    }\n  }, \"\\uD83D\\uDC68\\u200D\\uD83C\\uDF73\"), \" \\u015Eef\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 808,\n      columnNumber: 9\n    }\n  }, chatList.map(chat => /*#__PURE__*/React.createElement(\"div\", {\n    key: chat.id,\n    className: `chat-item ${chat.id === activeChatId ? 'active' : ''}`,\n    onClick: () => handleChatSelect(chat.id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 810,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"chat-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 815,\n      columnNumber: 15\n    }\n  }, chat.title || 'Yeni Sohbet'), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-actions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 816,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: e => {\n      e.stopPropagation();\n      deleteChat(chat.id);\n    },\n    className: \"delete-chat-button\",\n    title: \"Sohbeti sil\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 817,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    className: \"h-4 w-4\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    stroke: \"currentColor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 822,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    strokeWidth: 2,\n    d: \"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 823,\n      columnNumber: 21\n    }\n  }))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebar-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 831,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: clearChatHistory,\n    className: \"clear-chat-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 832,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    className: \"h-5 w-5\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    stroke: \"currentColor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 833,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    strokeWidth: 2,\n    d: \"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 834,\n      columnNumber: 15\n    }\n  })), \"Sohbeti Temizle\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-main\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 841,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 842,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: toggleSidebar,\n    className: \"sidebar-toggle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 843,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"24\",\n    height: \"24\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    stroke: \"currentColor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 844,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    strokeWidth: 2,\n    d: \"M4 6h16M4 12h16M4 18h16\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 845,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 848,\n      columnNumber: 11\n    }\n  }, \"Diyet Dostu AI\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"assistant-mode-indicator\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 849,\n      columnNumber: 11\n    }\n  }, assistantMode === 'dietician' && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"mode-badge dietician\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 850,\n      columnNumber: 47\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 850,\n      columnNumber: 86\n    }\n  }, \"\\uD83E\\uDD57\"), \" Diyetisyen\"), assistantMode === 'fitness' && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"mode-badge fitness\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 851,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 851,\n      columnNumber: 82\n    }\n  }, \"\\uD83D\\uDCAA\"), \" Fitness\"), assistantMode === 'chef' && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"mode-badge chef\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 852,\n      columnNumber: 42\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 852,\n      columnNumber: 76\n    }\n  }, \"\\uD83D\\uDC68\\u200D\\uD83C\\uDF73\"), \" \\u015Eef\"), assistantMode === 'general' && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"mode-badge general\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 853,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 853,\n      columnNumber: 82\n    }\n  }, \"\\uD83E\\uDD16\"), \" Genel\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"messages-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 857,\n      columnNumber: 9\n    }\n  }, messages.length === 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"welcome-message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 859,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 860,\n      columnNumber: 15\n    }\n  }, \"Diyet Dostu AI'a Ho\\u015F Geldiniz!\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 861,\n      columnNumber: 15\n    }\n  }, \"Beslenme, diyet veya fitness hakk\\u0131nda bir \\u015Feyler sor.\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"example-questions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 862,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setInput(\"Kilo vermek iÃ§in nasÄ±l beslenmeliyim?\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 863,\n      columnNumber: 17\n    }\n  }, \"Kilo vermek i\\xE7in nas\\u0131l beslenmeliyim?\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setInput(\"BugÃ¼n ne kadar protein almalÄ±yÄ±m?\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 866,\n      columnNumber: 17\n    }\n  }, \"Bug\\xFCn ne kadar protein almal\\u0131y\\u0131m?\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setInput(\"AkÅŸam yemeÄŸi iÃ§in saÄŸlÄ±klÄ± bir tarif Ã¶nerir misin?\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 869,\n      columnNumber: 17\n    }\n  }, \"Ak\\u015Fam yeme\\u011Fi i\\xE7in sa\\u011Fl\\u0131kl\\u0131 bir tarif \\xF6nerir misin?\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"assistant-modes-intro\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 873,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 874,\n      columnNumber: 17\n    }\n  }, \"Farkl\\u0131 Asistan Modlar\\u0131\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 875,\n      columnNumber: 17\n    }\n  }, \"\\u0130htiyac\\u0131n\\u0131za g\\xF6re asistan modunu de\\u011Fi\\u015Ftirebilirsiniz:\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 876,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 877,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 877,\n      columnNumber: 23\n    }\n  }, \"\\uD83E\\uDD57 Diyetisyen:\"), \" Ki\\u015Fisel beslenme plan\\u0131 ve tavsiyeler\"), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 878,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 878,\n      columnNumber: 23\n    }\n  }, \"\\uD83D\\uDCAA Fitness:\"), \" Egzersiz programlar\\u0131 ve aktivite \\xF6nerileri\"), /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 879,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 879,\n      columnNumber: 23\n    }\n  }, \"\\uD83D\\uDC68\\u200D\\uD83C\\uDF73 \\u015Eef:\"), \" Sa\\u011Fl\\u0131kl\\u0131 ve lezzetli tarifler\")), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 881,\n      columnNumber: 17\n    }\n  }, \"Mod de\\u011Fi\\u015Ftirmek i\\xE7in soldaki panelden se\\xE7im yapabilir veya \\u015Funlar\\u0131 yazabilirsiniz:\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 882,\n      columnNumber: 17\n    }\n  }, \"\\\"diyetisyen ol\\\", \\\"fitness ol\\\", \\\"\\u015Fef ol\\\", \\\"genel mod\\\"\"))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"messages-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 886,\n      columnNumber: 13\n    }\n  }, messages.map((msg, index) => renderMessageWithMode(msg, index))), isLoading && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loading-message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 892,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loading-avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 893,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"assistant-avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 894,\n      columnNumber: 17\n    }\n  }, assistantMode === 'dietician' && \"ðŸ¥—\", assistantMode === 'fitness' && \"ðŸ’ª\", assistantMode === 'chef' && \"ðŸ‘¨â€ðŸ³\", assistantMode === 'general' && \"ðŸ¤–\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loading-animation\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 901,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loading-dot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 902,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loading-dot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 903,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loading-dot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 904,\n      columnNumber: 17\n    }\n  }))), showUserInfoForm && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-info-form-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 911,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(UserInfoForm, {\n    onSubmit: handleUserInfoSubmit,\n    onCancel: () => setShowUserInfoForm(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 912,\n      columnNumber: 15\n    }\n  })), showDietPlan && userInfo && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"diet-plan-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 921,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(DietPlanGenerator, {\n    userInfo: userInfo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 922,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    ref: messagesEndRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 926,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 929,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"input-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 930,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"textarea-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 931,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"textarea\", {\n    value: input,\n    onChange: e => setInput(e.target.value),\n    onKeyDown: handleKeyDown,\n    ref: textareaRef,\n    placeholder: \"Diyet Dostu'na bir soru sor...\",\n    rows: \"1\",\n    className: \"chat-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 932,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"image-upload\",\n    className: \"upload-image-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 942,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    stroke: \"currentColor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 943,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    strokeWidth: 2,\n    d: \"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 944,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    id: \"image-upload\",\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: handleImageUpload,\n    className: \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 946,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    disabled: isLoading || !input.trim() && !imageFile,\n    className: \"send-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 956,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    stroke: \"currentColor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 961,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    strokeWidth: 2,\n    d: \"M14 5l7 7-7 7M5 5l7 7-7 7\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 962,\n      columnNumber: 17\n    }\n  })))), imagePreview && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"image-preview-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 968,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: imagePreview,\n    alt: \"Y\\xFCklenen g\\xF6rsel\",\n    className: \"image-preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 969,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: clearImage,\n    className: \"remove-image-button\",\n    title: \"G\\xF6rseli kald\\u0131r\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 970,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    className: \"h-4 w-4\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    stroke: \"currentColor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 975,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    strokeWidth: 2,\n    d: \"M6 18L18 6M6 6l12 12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 976,\n      columnNumber: 19\n    }\n  })))))), !keySubmitted ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"api-key-modal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 986,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"api-key-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 987,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 988,\n      columnNumber: 13\n    }\n  }, \"Gemini API Anahtar\\u0131 Gerekli\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 989,\n      columnNumber: 13\n    }\n  }, \"Diyet Dostu AI ile sohbet etmek i\\xE7in Gemini API anahtar\\u0131n\\u0131z\\u0131 girmeniz gerekiyor.\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmitApiKey,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 990,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: apiKey,\n    onChange: e => setApiKey(e.target.value),\n    className: \"api-key-input\",\n    placeholder: \"Gemini API anahtar\\u0131n\\u0131z\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 991,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"api-key-actions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 999,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"remember-checkbox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1000,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    defaultChecked: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1001,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1002,\n      columnNumber: 19\n    }\n  }, \"Bu bilgisayarda hat\\u0131rla\")), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"api-key-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1004,\n      columnNumber: 17\n    }\n  }, \"Devam Et\"))))) : null);\n};\nexport default Chat;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","ChatBubble","UserInfoForm","DietPlanGenerator","Chat","messages","setMessages","input","setInput","isLoading","setIsLoading","imageFile","setImageFile","imagePreview","setImagePreview","chatList","setChatList","activeChatId","setActiveChatId","sidebarOpen","setSidebarOpen","showUserInfoForm","setShowUserInfoForm","showDietPlan","setShowDietPlan","userInfo","setUserInfo","messagesEndRef","textareaRef","apiKey","setApiKey","keySubmitted","setKeySubmitted","assistantMode","setAssistantMode","assistantHistory","setAssistantHistory","fetchChatList","checkUserInfo","fetchApiKey","fetchChatHistory","scrollToBottom","token","localStorage","getItem","console","error","response","get","headers","Authorization","data","length","id","createNewChat","chatId","chatHistory","Array","isArray","post","then","newChat","title","lastMessage","Date","toISOString","prevList","role","content","catch","finally","deleteChat","window","confirm","delete","success","filter","chat","remainingChats","nextChat","alert","clearChatHistory","updatedList","map","current","scrollIntoView","behavior","handleKeyDown","e","key","shiftKey","preventDefault","handleSubmit","handleImageUpload","file","target","files","reader","FileReader","onloadend","result","readAsDataURL","clearImage","trim","userMessage","prevMessages","adjustTextareaHeight","formData","FormData","append","status","toLowerCase","includes","weight","height","age","changeAssistantMode","enhancedPrompt","message","request","handleUserInfoSubmit","setTimeout","prev","toggleSidebar","deleteNote","noteId","msg","type","handleSubmitApiKey","setItem","savedKey","mode","modeMessages","timestamp","startIndex","renderMessageWithMode","index","messageClass","avatarIcon","messageMode","reduce","historyItem","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onClick","xmlns","width","fill","viewBox","d","strokeWidth","stroke","strokeLinecap","handleChatSelect","stopPropagation","strokeLinejoin","onSubmit","onCancel","ref","value","onChange","onKeyDown","placeholder","rows","htmlFor","accept","disabled","src","alt","required","defaultChecked"],"sources":["C:/Users/Administrator/Desktop/specialdiet.ai/diyet-dostu-web/client/src/components/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport axios from 'axios';\r\nimport ChatBubble from './ChatBubble';\r\nimport UserInfoForm from './UserInfoForm';\r\nimport DietPlanGenerator from './DietPlanGenerator';\r\n\r\nconst Chat = () => {\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [imageFile, setImageFile] = useState(null);\r\n  const [imagePreview, setImagePreview] = useState(null);\r\n  const [chatList, setChatList] = useState([]);\r\n  const [activeChatId, setActiveChatId] = useState(null);\r\n  const [sidebarOpen, setSidebarOpen] = useState(true);\r\n  const [showUserInfoForm, setShowUserInfoForm] = useState(false);\r\n  const [showDietPlan, setShowDietPlan] = useState(false);\r\n  const [userInfo, setUserInfo] = useState(null);\r\n  const messagesEndRef = useRef(null);\r\n  const textareaRef = useRef(null);\r\n  const [apiKey, setApiKey] = useState('');\r\n  const [keySubmitted, setKeySubmitted] = useState(true);\r\n  const [assistantMode, setAssistantMode] = useState('general');\r\n  const [assistantHistory, setAssistantHistory] = useState([]);\r\n\r\n  useEffect(() => {\r\n    fetchChatList();\r\n    checkUserInfo();\r\n    \r\n    // .env veya server API'den API anahtarÄ±nÄ± al\r\n    fetchApiKey();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (activeChatId) {\r\n      fetchChatHistory();\r\n    }\r\n  }, [activeChatId]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages, showUserInfoForm, showDietPlan]);\r\n\r\n  const checkUserInfo = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        return;\r\n      }\r\n      \r\n      const response = await axios.get('/api/user-info', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      if (response.data.userInfo) {\r\n        setUserInfo(response.data.userInfo);\r\n      } else {\r\n        // KullanÄ±cÄ± bilgisi yoksa formu gÃ¶ster\r\n        // GerÃ§ek uygulamada sohbet baÅŸlattÄ±ktan sonra gÃ¶ster\r\n        // Åžimdilik yorum satÄ±rÄ± olarak bÄ±rakÄ±yoruz\r\n        // setShowUserInfoForm(true);\r\n      }\r\n    } catch (error) {\r\n      console.error('KullanÄ±cÄ± bilgisi kontrolÃ¼ sÄ±rasÄ±nda hata:', error);\r\n    }\r\n  };\r\n\r\n  const fetchChatList = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      const response = await axios.get('/api/chat-list', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      // Sohbet listesini ayarla\r\n      setChatList(response.data);\r\n      \r\n      // Ä°lk sohbeti aktif olarak iÅŸaretle (eÄŸer liste boÅŸ deÄŸilse)\r\n      if (response.data.length > 0 && !activeChatId) {\r\n        setActiveChatId(response.data[0].id);\r\n        fetchChatHistory(response.data[0].id);\r\n      } else if (response.data.length === 0) {\r\n        // Sohbet listesi boÅŸsa yeni bir sohbet oluÅŸtur\r\n        createNewChat();\r\n      }\r\n    } catch (error) {\r\n      console.error('Sohbet listesi alÄ±nÄ±rken hata:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchChatHistory = async (chatId) => {\r\n    try {\r\n      setIsLoading(true);\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      const response = await axios.get(`/api/chat-history/${chatId}`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      // BaÅŸarÄ±lÄ± yanÄ±tta mesajlarÄ± gÃ¼ncelle\r\n      if (response.data.chatHistory && Array.isArray(response.data.chatHistory)) {\r\n        setMessages(response.data.chatHistory);\r\n      } else {\r\n        // BoÅŸ mesaj listesi\r\n        setMessages([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Sohbet geÃ§miÅŸi alÄ±nÄ±rken hata:', error);\r\n      setMessages([]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const createNewChat = () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      // Yeni sohbet oluÅŸtur\r\n      axios.post('/api/create-chat', {}, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      })\r\n      .then(response => {\r\n        if (response.data && response.data.id) {\r\n          // Yeni sohbeti listeye ekle\r\n          const newChat = {\r\n            id: response.data.id,\r\n            title: response.data.title || 'Yeni Sohbet',\r\n            lastMessage: new Date().toISOString()\r\n          };\r\n          \r\n          setChatList(prevList => [...prevList, newChat]);\r\n          setActiveChatId(response.data.id);\r\n          \r\n          // Yeni sohbetin geÃ§miÅŸini yÃ¼kle (boÅŸ olacak)\r\n          setMessages([{\r\n            role: 'assistant',\r\n            content: `Merhaba! ðŸ˜Š Diyet Dostu'na hoÅŸ geldin!\r\n\r\nBen senin kiÅŸisel beslenme ve spor asistanÄ±nÄ±m. Bana istediÄŸin konuda soru sorabilirsin.\r\n\r\nTÃ¼rk mutfaÄŸÄ±na uygun, kolay ve saÄŸlÄ±klÄ± tarifler sunarak diyet hedeflerine ulaÅŸmana yardÄ±mcÄ± olacaÄŸÄ±m.\r\n\r\nÄ°ÅŸte sana yardÄ±mcÄ± olabileceÄŸim konular:\r\nðŸ¥— TÃ¼rk mutfaÄŸÄ±na uygun dÃ¼ÅŸÃ¼k kalorili/yÃ¼ksek proteinli tarifler\r\nðŸ‹ï¸â€â™€ï¸ KiÅŸiselleÅŸtirilmiÅŸ egzersiz planlarÄ±\r\nðŸ“¸ Yemek fotoÄŸraflarÄ±nÄ± analiz ederek besin deÄŸeri tahmini\r\nðŸ“ HaftalÄ±k beslenme programÄ± oluÅŸturma\r\nðŸ“Š Kilo takibi ve geliÅŸim analizi\r\n\r\nSormak istediÄŸin bir ÅŸey var mÄ±? Birlikte saÄŸlÄ±klÄ± bir yaÅŸam yolculuÄŸuna baÅŸlayalÄ±m! ðŸ’ª`\r\n          }]);\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error('Yeni sohbet oluÅŸturulurken hata:', error);\r\n      })\r\n      .finally(() => {\r\n        setIsLoading(false);\r\n      });\r\n    } catch (error) {\r\n      console.error('Yeni sohbet oluÅŸturulurken hata:', error);\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const deleteChat = async (chatId) => {\r\n    if (!window.confirm('Bu sohbeti silmek istediÄŸinizden emin misiniz?')) {\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      // API'ya istek gÃ¶nder\r\n      const response = await axios.delete(`/api/delete-chat/${chatId}`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      // BaÅŸarÄ±lÄ± yanÄ±tta UI'Ä± gÃ¼ncelle\r\n      if (response.data.success) {\r\n        // Sohbet listesinden sil\r\n        setChatList(prevList => prevList.filter(chat => chat.id !== chatId));\r\n        \r\n        // EÄŸer aktif sohbet siliniyorsa baÅŸka bir sohbete geÃ§\r\n        if (chatId === activeChatId) {\r\n          const remainingChats = chatList.filter(chat => chat.id !== chatId);\r\n          const nextChat = remainingChats.length > 0 ? remainingChats[0] : null;\r\n          \r\n          if (nextChat) {\r\n            setActiveChatId(nextChat.id);\r\n            // Bu sohbetin geÃ§miÅŸini yÃ¼kle\r\n            fetchChatHistory(nextChat.id);\r\n          } else {\r\n            // HiÃ§ sohbet kalmadÄ±ysa yeni bir sohbet oluÅŸtur\r\n            createNewChat();\r\n          }\r\n        }\r\n        \r\n        // Bildirim gÃ¶ster\r\n        alert('Sohbet baÅŸarÄ±yla silindi.');\r\n      } else {\r\n        alert('Sohbet silinirken bir hata oluÅŸtu.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Sohbet silinirken hata:', error);\r\n      alert('Sohbet silinirken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const clearChatHistory = async () => {\r\n    try {\r\n      if (!window.confirm('Sohbet geÃ§miÅŸini temizlemek istediÄŸinizden emin misiniz?')) {\r\n        return;\r\n      }\r\n      \r\n      setIsLoading(true);\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      // API'ya istek gÃ¶nder\r\n      const response = await axios.post('/api/clear-chat', {}, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      if (response.data.success) {\r\n        // BaÅŸarÄ±lÄ± yanÄ±tta mesajlarÄ± gÃ¼ncelle\r\n        setMessages(response.data.chatHistory || [{\r\n          role: 'assistant',\r\n          content: `Merhaba! ðŸ˜Š Diyet Dostu'na hoÅŸ geldin!\r\n\r\nBen senin kiÅŸisel beslenme ve spor asistanÄ±nÄ±m. Sohbet geÃ§miÅŸin temizlendi ve yeni bir konuÅŸma baÅŸlatÄ±ldÄ±.\r\n\r\nTÃ¼rk mutfaÄŸÄ±na uygun, kolay ve saÄŸlÄ±klÄ± tarifler sunarak diyet hedeflerine ulaÅŸmana yardÄ±mcÄ± olacaÄŸÄ±m.\r\n\r\nÄ°ÅŸte sana yardÄ±mcÄ± olabileceÄŸim konular:\r\nðŸ¥— TÃ¼rk mutfaÄŸÄ±na uygun dÃ¼ÅŸÃ¼k kalorili/yÃ¼ksek proteinli tarifler\r\nðŸ‹ï¸â€â™€ï¸ KiÅŸiselleÅŸtirilmiÅŸ egzersiz planlarÄ±\r\nðŸ“¸ Yemek fotoÄŸraflarÄ±nÄ± analiz ederek besin deÄŸeri tahmini\r\nðŸ“ HaftalÄ±k beslenme programÄ± oluÅŸturma\r\nðŸ“Š Kilo takibi ve geliÅŸim analizi\r\n\r\nSormak istediÄŸin bir ÅŸey var mÄ±? Birlikte saÄŸlÄ±klÄ± bir yaÅŸam yolculuÄŸuna baÅŸlayalÄ±m! ðŸ’ª`\r\n        }]);\r\n        \r\n        // Aktif sohbeti gÃ¼ncelle\r\n        const updatedList = chatList.map(chat => {\r\n          if (chat.id === activeChatId) {\r\n            return { ...chat, title: 'TemizlenmiÅŸ Sohbet' };\r\n          }\r\n          return chat;\r\n        });\r\n        \r\n        setChatList(updatedList);\r\n        \r\n        // FormlarÄ± gizle\r\n        setShowUserInfoForm(false);\r\n        setShowDietPlan(false);\r\n        \r\n        // BaÅŸarÄ± mesajÄ± gÃ¶ster\r\n        alert('Sohbet geÃ§miÅŸi baÅŸarÄ±yla temizlendi.');\r\n      } else {\r\n        // Hata mesajÄ±\r\n        alert('Sohbet geÃ§miÅŸi temizlenirken bir hata oluÅŸtu.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Sohbet geÃ§miÅŸi temizlenirken hata:', error);\r\n      // Hata durumunda kullanÄ±cÄ±yÄ± bilgilendir\r\n      alert('Sohbet geÃ§miÅŸi temizlenirken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    if (messagesEndRef.current) {\r\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  const handleKeyDown = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit(e);\r\n    }\r\n  };\r\n\r\n  const handleImageUpload = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setImageFile(file);\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        setImagePreview(reader.result);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const clearImage = () => {\r\n    setImageFile(null);\r\n    setImagePreview(null);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if ((!input.trim() && !imageFile) || isLoading) return;\r\n    \r\n    // KullanÄ±cÄ± mesajÄ±nÄ± ekle\r\n    const userMessage = input.trim();\r\n    setMessages(prevMessages => [...prevMessages, { role: 'user', content: userMessage }]);\r\n    setInput('');\r\n    setIsLoading(true);\r\n    adjustTextareaHeight();\r\n    \r\n    // Resim varsa, yÃ¼klenen iÅŸlemi gerÃ§ekleÅŸtir\r\n    if (imageFile) {\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append('image', imageFile);\r\n        \r\n        const token = localStorage.getItem('token');\r\n        \r\n        if (!token) {\r\n          console.error('Token bulunamadÄ±');\r\n          setMessages(prevMessages => [...prevMessages, { \r\n            role: 'assistant', \r\n            content: 'Oturumunuz sona ermiÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.' \r\n          }]);\r\n          setIsLoading(false);\r\n          return;\r\n        }\r\n        \r\n        const response = await axios.post(`/api/analyze-image`, formData, {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        });\r\n        \r\n        clearImage();\r\n        \r\n        // GÃ¶rÃ¼ntÃ¼ analiz edildikten sonra cevap sohbete eklenecek\r\n        // API tetikleyecek sohbet geÃ§miÅŸini sunucudan alacak\r\n        fetchChatHistory(activeChatId);\r\n      } catch (error) {\r\n        console.error('GÃ¶rÃ¼ntÃ¼ yÃ¼kleme hatasÄ±:', error);\r\n        \r\n        if (error.response) {\r\n          if (error.response.status === 401) {\r\n            setMessages(prevMessages => [...prevMessages, { \r\n              role: 'assistant', \r\n              content: 'Oturumunuz sona ermiÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.' \r\n            }]);\r\n          } else if (error.response.status === 413) {\r\n            setMessages(prevMessages => [...prevMessages, { \r\n              role: 'assistant', \r\n              content: 'GÃ¶rÃ¼ntÃ¼ boyutu Ã§ok bÃ¼yÃ¼k. LÃ¼tfen daha kÃ¼Ã§Ã¼k bir gÃ¶rÃ¼ntÃ¼ yÃ¼kleyin.' \r\n            }]);\r\n          } else {\r\n            setMessages(prevMessages => [...prevMessages, { \r\n              role: 'assistant', \r\n              content: 'GÃ¶rÃ¼ntÃ¼yÃ¼ iÅŸlerken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.' \r\n            }]);\r\n          }\r\n        } else {\r\n          setMessages(prevMessages => [...prevMessages, { \r\n            role: 'assistant', \r\n            content: 'GÃ¶rÃ¼ntÃ¼yÃ¼ iÅŸlerken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.' \r\n          }]);\r\n        }\r\n        \r\n        clearImage();\r\n        setIsLoading(false);\r\n      }\r\n      \r\n      return;\r\n    }\r\n    \r\n    try {\r\n      // KiÅŸisel bilgi sorusu\r\n      if (userMessage.toLowerCase().includes('kiÅŸisel bilgi') || \r\n          userMessage.toLowerCase().includes('bilgilerim') ||\r\n          userMessage.toLowerCase().includes('profilim')) {\r\n        setIsLoading(false);\r\n        setShowUserInfoForm(true);\r\n        return;\r\n      }\r\n      \r\n      // Diyet planÄ± istemi\r\n      if (userMessage.toLowerCase().includes('diyet planÄ±') || \r\n          userMessage.toLowerCase().includes('beslenme planÄ±')) {\r\n        setIsLoading(false);\r\n        setShowDietPlan(true);\r\n        \r\n        // Bilgi eksikliÄŸi kontrolÃ¼\r\n        if (!userInfo || !userInfo.weight || !userInfo.height || !userInfo.age) {\r\n          setMessages(prevMessages => [...prevMessages, { \r\n            role: 'assistant', \r\n            content: 'Size Ã¶zel bir diyet planÄ± oluÅŸturabilmem iÃ§in kiÅŸisel bilgilerinize ihtiyacÄ±m var. LÃ¼tfen kiÅŸisel bilgilerinizi gÃ¼ncelleyin.' \r\n          }]);\r\n          setShowUserInfoForm(true);\r\n        }\r\n        \r\n        return;\r\n      }\r\n\r\n      // AI Asistan modu komutlarÄ± kontrolÃ¼\r\n      if (userMessage.toLowerCase().includes('diyetisyen ol') || \r\n          userMessage.toLowerCase().includes('diyetisyen modu')) {\r\n        changeAssistantMode('dietician');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      if (userMessage.toLowerCase().includes('fitness') || \r\n          userMessage.toLowerCase().includes('antrenÃ¶r ol') ||\r\n          userMessage.toLowerCase().includes('egzersiz modu')) {\r\n        changeAssistantMode('fitness');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      if (userMessage.toLowerCase().includes('ÅŸef ol') || \r\n          userMessage.toLowerCase().includes('aÅŸÃ§Ä± ol') ||\r\n          userMessage.toLowerCase().includes('tarif modu')) {\r\n        changeAssistantMode('chef');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      if (userMessage.toLowerCase().includes('genel mod') || \r\n          userMessage.toLowerCase().includes('normal mod')) {\r\n        changeAssistantMode('general');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      // AI asistan isteÄŸini hazÄ±rla\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        setMessages(prevMessages => [...prevMessages, { \r\n          role: 'assistant', \r\n          content: 'Oturumunuz sona ermiÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.' \r\n        }]);\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      // Asistan moduna gÃ¶re prompt'u hazÄ±rla\r\n      let enhancedPrompt = userMessage;\r\n      \r\n      if (assistantMode === 'dietician') {\r\n        enhancedPrompt = `[DÄ°YETÄ°SYEN MODU] Bir diyetisyen olarak yanÄ±t ver: ${userMessage}`;\r\n      } else if (assistantMode === 'fitness') {\r\n        enhancedPrompt = `[FÄ°TNESS MODU] Bir fitness antrenÃ¶rÃ¼ olarak yanÄ±t ver: ${userMessage}`;\r\n      } else if (assistantMode === 'chef') {\r\n        enhancedPrompt = `[ÅžEF MODU] Bir ÅŸef olarak saÄŸlÄ±klÄ± tarifler Ã¶ner: ${userMessage}`;\r\n      }\r\n      \r\n      const response = await axios.post(`/api/chat`, \r\n        { \r\n          message: enhancedPrompt, \r\n          chatId: activeChatId,\r\n          assistantMode: assistantMode \r\n        }, \r\n        {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        }\r\n      );\r\n      \r\n      // Sunucudan gelen yanÄ±tÄ± ekle\r\n      if (response.data && response.data.response) {\r\n        setMessages(prevMessages => [...prevMessages, { \r\n          role: 'assistant', \r\n          content: response.data.response \r\n        }]);\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Mesaj gÃ¶nderme hatasÄ±:', error);\r\n      \r\n      if (error.response) {\r\n        if (error.response.status === 401) {\r\n          setMessages(prevMessages => [...prevMessages, { \r\n            role: 'assistant', \r\n            content: 'Oturumunuz sona ermiÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.' \r\n          }]);\r\n        } else if (error.response.status === 403) {\r\n          setMessages(prevMessages => [...prevMessages, { \r\n            role: 'assistant', \r\n            content: 'Bu iÅŸlemi gerÃ§ekleÅŸtirmek iÃ§in yetkiniz yok.' \r\n          }]);\r\n        } else if (error.response.status === 404) {\r\n          setMessages(prevMessages => [...prevMessages, { \r\n            role: 'assistant', \r\n            content: 'API endpoint\\'i bulunamadÄ±.' \r\n          }]);\r\n        } else if (error.response.status === 500) {\r\n          setMessages(prevMessages => [...prevMessages, { \r\n            role: 'assistant', \r\n            content: 'Sunucu hatasÄ±. LÃ¼tfen daha sonra tekrar deneyin.' \r\n          }]);\r\n        } else {\r\n          setMessages(prevMessages => [...prevMessages, { \r\n            role: 'assistant', \r\n            content: 'Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.' \r\n          }]);\r\n        }\r\n      } else if (error.request) {\r\n        setMessages(prevMessages => [...prevMessages, { \r\n          role: 'assistant', \r\n          content: 'Sunucuya baÄŸlanÄ±rken bir hata oluÅŸtu. Ä°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin.' \r\n        }]);\r\n      } else {\r\n        setMessages(prevMessages => [...prevMessages, { \r\n          role: 'assistant', \r\n          content: 'Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.' \r\n        }]);\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleUserInfoSubmit = (formData) => {\r\n    // KullanÄ±cÄ± bilgilerini kaydet\r\n    setUserInfo(formData);\r\n    setShowUserInfoForm(false);\r\n    \r\n    // KullanÄ±cÄ± bilgileri alÄ±ndÄ±ÄŸÄ±nda diyet planÄ±nÄ± gÃ¶ster\r\n    setTimeout(() => {\r\n      setMessages((prev) => [...prev, {\r\n        role: 'assistant',\r\n        content: `TeÅŸekkÃ¼rler! Bilgileriniz kaydedildi. \r\n\r\nSize Ã¶zel bir beslenme planÄ± hazÄ±rlÄ±yorum. Bu plan, hedeflerinize, tercihlerinize ve ihtiyaÃ§larÄ±nÄ±za gÃ¶re Ã¶zelleÅŸtirilmiÅŸtir.\r\n\r\nÄ°ÅŸte size Ã¶zel beslenme planÄ±m:`\r\n      }]);\r\n      \r\n      setTimeout(() => {\r\n        setShowDietPlan(true);\r\n      }, 1000);\r\n    }, 500);\r\n  };\r\n\r\n  const toggleSidebar = () => {\r\n    setSidebarOpen(!sidebarOpen);\r\n  };\r\n\r\n  // Eksik olduÄŸu iÃ§in not silme fonksiyonunu ekliyorum\r\n  const deleteNote = async (noteId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        return;\r\n      }\r\n      \r\n      const response = await axios.delete(`/api/delete-note/${noteId}`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      if (response.data.success) {\r\n        // Notu listeden kaldÄ±r\r\n        setMessages(messages.filter(msg => {\r\n          // Not ID'si mesaj iÃ§inde tanÄ±mlanmÄ±ÅŸsa (data-note-id gibi bir Ã¶zellik ile)\r\n          return !(msg.type === 'note' && msg.noteId === noteId);\r\n        }));\r\n        \r\n        // Bildirim gÃ¶ster\r\n        alert('Not baÅŸarÄ±yla silindi');\r\n      } else {\r\n        alert('Not silinirken bir hata oluÅŸtu');\r\n      }\r\n    } catch (error) {\r\n      console.error('Not silinirken hata:', error);\r\n      alert('Not silinirken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.');\r\n    }\r\n  };\r\n\r\n  const handleSubmitApiKey = (e) => {\r\n    e.preventDefault();\r\n    if (apiKey) {\r\n      localStorage.setItem('geminiApiKey', apiKey);\r\n      setKeySubmitted(true);\r\n      \r\n      // API anahtarÄ±nÄ± sunucuya gÃ¶nder\r\n      const token = localStorage.getItem('token');\r\n      if (token) {\r\n        axios.post('/api/save-api-key', { apiKey }, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        }).catch(error => {\r\n          console.error('API anahtarÄ± kaydedilirken hata:', error);\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  // API anahtarÄ±nÄ± sunucudan veya .env dosyasÄ±ndan al\r\n  const fetchApiKey = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        console.error('Token bulunamadÄ±');\r\n        return;\r\n      }\r\n      \r\n      // Sunucudan API anahtarÄ±nÄ± alma isteÄŸi\r\n      const response = await axios.get('/api/get-api-key', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      if (response.data && response.data.apiKey) {\r\n        setApiKey(response.data.apiKey);\r\n        setKeySubmitted(true);\r\n      } else {\r\n        // EÄŸer localStorage'da kayÄ±tlÄ± bir anahtar varsa onu kullan\r\n        const savedKey = localStorage.getItem('geminiApiKey');\r\n        if (savedKey) {\r\n          setApiKey(savedKey);\r\n          setKeySubmitted(true);\r\n        } else {\r\n          // EÄŸer API anahtarÄ± yoksa ve kullanÄ±cÄ± girmediyse, modal gÃ¶ster\r\n          setKeySubmitted(false);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('API anahtarÄ± alÄ±nÄ±rken hata:', error);\r\n      \r\n      // EÄŸer localStorage'da kayÄ±tlÄ± bir anahtar varsa onu kullan\r\n      const savedKey = localStorage.getItem('geminiApiKey');\r\n      if (savedKey) {\r\n        setApiKey(savedKey);\r\n        setKeySubmitted(true);\r\n      } else {\r\n        // EÄŸer API anahtarÄ± yoksa ve kullanÄ±cÄ± girmediyse, modal gÃ¶ster\r\n        setKeySubmitted(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Asistan modlarÄ±nÄ± deÄŸiÅŸtirme fonksiyonu\r\n  const changeAssistantMode = (mode) => {\r\n    setAssistantMode(mode);\r\n    // KullanÄ±cÄ±ya mod deÄŸiÅŸikliÄŸi hakkÄ±nda bilgi ver\r\n    const modeMessages = {\r\n      'general': 'Genel mod: Size saÄŸlÄ±klÄ± yaÅŸam konusunda yardÄ±mcÄ± olabilirim.',\r\n      'dietician': 'Diyetisyen mod: Size kiÅŸisel beslenme planÄ± ve Ã¶neriler sunabilirim.',\r\n      'fitness': 'Fitness mod: Size egzersiz programlarÄ± ve aktivite Ã¶nerileri sunabilirim.',\r\n      'chef': 'Åžef mod: Size saÄŸlÄ±klÄ± ve lezzetli tarifler Ã¶nerebilirim.'\r\n    };\r\n    \r\n    // Mod deÄŸiÅŸikliÄŸi mesajÄ±nÄ± ekle\r\n    setMessages(prev => [...prev, {\r\n      role: 'assistant',\r\n      content: modeMessages[mode],\r\n      timestamp: new Date().toISOString()\r\n    }]);\r\n    \r\n    // Yeni modun baÄŸlamÄ±nÄ± korumak iÃ§in histori kaydet\r\n    setAssistantHistory(prev => [...prev, { mode, startIndex: messages.length }]);\r\n  };\r\n\r\n  // MesajÄ± asistan moduna gÃ¶re render et\r\n  const renderMessageWithMode = (msg, index) => {\r\n    let messageClass = \"message\";\r\n    let avatarIcon = \"ðŸ¥—\";\r\n\r\n    // Asistan moduna gÃ¶re ikon belirle\r\n    if (msg.role === 'assistant') {\r\n      if (assistantHistory.length > 0) {\r\n        // MesajÄ±n hangi modda gÃ¶nderildiÄŸini bul\r\n        const messageMode = assistantHistory.reduce((current, historyItem) => {\r\n          if (index >= historyItem.startIndex) {\r\n            return historyItem.mode;\r\n          }\r\n          return current;\r\n        }, 'general');\r\n\r\n        // Moda gÃ¶re ikon belirle\r\n        switch (messageMode) {\r\n          case 'dietician':\r\n            avatarIcon = \"ðŸ¥—\";\r\n            messageClass += \" dietician-message\";\r\n            break;\r\n          case 'fitness':\r\n            avatarIcon = \"ðŸ’ª\";\r\n            messageClass += \" fitness-message\";\r\n            break;\r\n          case 'chef':\r\n            avatarIcon = \"ðŸ‘¨â€ðŸ³\";\r\n            messageClass += \" chef-message\";\r\n            break;\r\n          default:\r\n            avatarIcon = \"ðŸ¤–\";\r\n            messageClass += \" general-message\";\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div key={index} className={`message-container ${msg.role}`}>\r\n        {msg.role === 'assistant' && (\r\n          <div className=\"avatar-container\">\r\n            <div className=\"assistant-avatar\">{avatarIcon}</div>\r\n          </div>\r\n        )}\r\n        <div className={msg.role === 'user' ? 'user-message' : messageClass}>\r\n          {msg.content}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat-container\">\r\n      <div className={`sidebar ${sidebarOpen ? 'open' : ''}`}>\r\n        <div className=\"sidebar-header\">\r\n          <h2>Sohbetler</h2>\r\n          <button onClick={createNewChat} className=\"new-chat-button\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path d=\"M12 4v16m8-8H4\" strokeWidth=\"2\" stroke=\"currentColor\" strokeLinecap=\"round\" />\r\n            </svg>\r\n            <span>Yeni Sohbet</span>\r\n          </button>\r\n        </div>\r\n        \r\n        {/* Asistan modu seÃ§ici */}\r\n        <div className=\"assistant-mode-switcher\">\r\n          <h3>Asistan Modu</h3>\r\n          <div className=\"mode-buttons\">\r\n            <button \r\n              className={`mode-button ${assistantMode === 'general' ? 'active' : ''}`}\r\n              onClick={() => changeAssistantMode('general')}\r\n            >\r\n              <span>ðŸ¤–</span> Genel\r\n            </button>\r\n            <button \r\n              className={`mode-button ${assistantMode === 'dietician' ? 'active' : ''}`}\r\n              onClick={() => changeAssistantMode('dietician')}\r\n            >\r\n              <span>ï¿½ï¿½</span> Diyetisyen\r\n            </button>\r\n            <button \r\n              className={`mode-button ${assistantMode === 'fitness' ? 'active' : ''}`}\r\n              onClick={() => changeAssistantMode('fitness')}\r\n            >\r\n              <span>ðŸ’ª</span> Fitness\r\n            </button>\r\n            <button \r\n              className={`mode-button ${assistantMode === 'chef' ? 'active' : ''}`}\r\n              onClick={() => changeAssistantMode('chef')}\r\n            >\r\n              <span>ðŸ‘¨â€ðŸ³</span> Åžef\r\n            </button>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Mevcut sohbet listesi */}\r\n        <div className=\"chat-list\">\r\n          {chatList.map(chat => (\r\n            <div \r\n              key={chat.id} \r\n              className={`chat-item ${chat.id === activeChatId ? 'active' : ''}`}\r\n              onClick={() => handleChatSelect(chat.id)}\r\n            >\r\n              <span className=\"chat-title\">{chat.title || 'Yeni Sohbet'}</span>\r\n              <div className=\"chat-actions\">\r\n                <button \r\n                  onClick={(e) => { e.stopPropagation(); deleteChat(chat.id); }}\r\n                  className=\"delete-chat-button\"\r\n                  title=\"Sohbeti sil\"\r\n                >\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        \r\n        <div className=\"sidebar-footer\">\r\n          <button onClick={clearChatHistory} className=\"clear-chat-button\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n            </svg>\r\n            Sohbeti Temizle\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"chat-main\">\r\n        <div className=\"chat-header\">\r\n          <button onClick={toggleSidebar} className=\"sidebar-toggle\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\r\n            </svg>\r\n          </button>\r\n          <h1>Diyet Dostu AI</h1>\r\n          <div className=\"assistant-mode-indicator\">\r\n            {assistantMode === 'dietician' && <span className=\"mode-badge dietician\"><span>ðŸ¥—</span> Diyetisyen</span>}\r\n            {assistantMode === 'fitness' && <span className=\"mode-badge fitness\"><span>ðŸ’ª</span> Fitness</span>}\r\n            {assistantMode === 'chef' && <span className=\"mode-badge chef\"><span>ðŸ‘¨â€ðŸ³</span> Åžef</span>}\r\n            {assistantMode === 'general' && <span className=\"mode-badge general\"><span>ðŸ¤–</span> Genel</span>}\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"messages-container\">\r\n          {messages.length === 0 ? (\r\n            <div className=\"welcome-message\">\r\n              <h2>Diyet Dostu AI'a HoÅŸ Geldiniz!</h2>\r\n              <p>Beslenme, diyet veya fitness hakkÄ±nda bir ÅŸeyler sor.</p>\r\n              <div className=\"example-questions\">\r\n                <button onClick={() => setInput(\"Kilo vermek iÃ§in nasÄ±l beslenmeliyim?\")}>\r\n                  Kilo vermek iÃ§in nasÄ±l beslenmeliyim?\r\n                </button>\r\n                <button onClick={() => setInput(\"BugÃ¼n ne kadar protein almalÄ±yÄ±m?\")}>\r\n                  BugÃ¼n ne kadar protein almalÄ±yÄ±m?\r\n                </button>\r\n                <button onClick={() => setInput(\"AkÅŸam yemeÄŸi iÃ§in saÄŸlÄ±klÄ± bir tarif Ã¶nerir misin?\")}>\r\n                  AkÅŸam yemeÄŸi iÃ§in saÄŸlÄ±klÄ± bir tarif Ã¶nerir misin?\r\n                </button>\r\n              </div>\r\n              <div className=\"assistant-modes-intro\">\r\n                <h3>FarklÄ± Asistan ModlarÄ±</h3>\r\n                <p>Ä°htiyacÄ±nÄ±za gÃ¶re asistan modunu deÄŸiÅŸtirebilirsiniz:</p>\r\n                <ul>\r\n                  <li><strong>ðŸ¥— Diyetisyen:</strong> KiÅŸisel beslenme planÄ± ve tavsiyeler</li>\r\n                  <li><strong>ðŸ’ª Fitness:</strong> Egzersiz programlarÄ± ve aktivite Ã¶nerileri</li>\r\n                  <li><strong>ðŸ‘¨â€ðŸ³ Åžef:</strong> SaÄŸlÄ±klÄ± ve lezzetli tarifler</li>\r\n                </ul>\r\n                <p>Mod deÄŸiÅŸtirmek iÃ§in soldaki panelden seÃ§im yapabilir veya ÅŸunlarÄ± yazabilirsiniz:</p>\r\n                <p>\"diyetisyen ol\", \"fitness ol\", \"ÅŸef ol\", \"genel mod\"</p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"messages-list\">\r\n              {messages.map((msg, index) => renderMessageWithMode(msg, index))}\r\n            </div>\r\n          )}\r\n          \r\n          {isLoading && (\r\n            <div className=\"loading-message\">\r\n              <div className=\"loading-avatar\">\r\n                <div className=\"assistant-avatar\">\r\n                  {assistantMode === 'dietician' && \"ðŸ¥—\"}\r\n                  {assistantMode === 'fitness' && \"ðŸ’ª\"}\r\n                  {assistantMode === 'chef' && \"ðŸ‘¨â€ðŸ³\"}\r\n                  {assistantMode === 'general' && \"ðŸ¤–\"}\r\n                </div>\r\n              </div>\r\n              <div className=\"loading-animation\">\r\n                <div className=\"loading-dot\"></div>\r\n                <div className=\"loading-dot\"></div>\r\n                <div className=\"loading-dot\"></div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {/* KullanÄ±cÄ± bilgi formu */}\r\n          {showUserInfoForm && (\r\n            <div className=\"user-info-form-container\">\r\n              <UserInfoForm \r\n                onSubmit={handleUserInfoSubmit} \r\n                onCancel={() => setShowUserInfoForm(false)}\r\n              />\r\n            </div>\r\n          )}\r\n          \r\n          {/* Diyet planÄ± */}\r\n          {showDietPlan && userInfo && (\r\n            <div className=\"diet-plan-container\">\r\n              <DietPlanGenerator userInfo={userInfo} />\r\n            </div>\r\n          )}\r\n          \r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n\r\n        <div className=\"input-container\">\r\n          <form onSubmit={handleSubmit} className=\"input-form\">\r\n            <div className=\"textarea-container\">\r\n              <textarea\r\n                value={input}\r\n                onChange={(e) => setInput(e.target.value)}\r\n                onKeyDown={handleKeyDown}\r\n                ref={textareaRef}\r\n                placeholder=\"Diyet Dostu'na bir soru sor...\"\r\n                rows=\"1\"\r\n                className=\"chat-input\"\r\n              ></textarea>\r\n              \r\n              <label htmlFor=\"image-upload\" className=\"upload-image-button\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n                </svg>\r\n                <input\r\n                  id=\"image-upload\"\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  onChange={handleImageUpload}\r\n                  className=\"hidden\"\r\n                />\r\n              </label>\r\n            </div>\r\n            \r\n            <button\r\n              type=\"submit\"\r\n              disabled={isLoading || (!input.trim() && !imageFile)}\r\n              className=\"send-button\"\r\n            >\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M14 5l7 7-7 7M5 5l7 7-7 7\" />\r\n              </svg>\r\n            </button>\r\n          </form>\r\n          \r\n          {imagePreview && (\r\n            <div className=\"image-preview-container\">\r\n              <img src={imagePreview} alt=\"YÃ¼klenen gÃ¶rsel\" className=\"image-preview\" />\r\n              <button \r\n                onClick={clearImage}\r\n                className=\"remove-image-button\"\r\n                title=\"GÃ¶rseli kaldÄ±r\"\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* API Key Modal */}\r\n      {!keySubmitted ? (\r\n        <div className=\"api-key-modal\">\r\n          <div className=\"api-key-container\">\r\n            <h2>Gemini API AnahtarÄ± Gerekli</h2>\r\n            <p>Diyet Dostu AI ile sohbet etmek iÃ§in Gemini API anahtarÄ±nÄ±zÄ± girmeniz gerekiyor.</p>\r\n            <form onSubmit={handleSubmitApiKey}>\r\n              <input\r\n                type=\"text\"\r\n                value={apiKey}\r\n                onChange={(e) => setApiKey(e.target.value)}\r\n                className=\"api-key-input\"\r\n                placeholder=\"Gemini API anahtarÄ±nÄ±z\"\r\n                required\r\n              />\r\n              <div className=\"api-key-actions\">\r\n                <label className=\"remember-checkbox\">\r\n                  <input type=\"checkbox\" defaultChecked />\r\n                  <span>Bu bilgisayarda hatÄ±rla</span>\r\n                </label>\r\n                <button type=\"submit\" className=\"api-key-button\">Devam Et</button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}